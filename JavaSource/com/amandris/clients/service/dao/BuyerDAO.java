package com.amandris.clients.service.dao;import java.util.Collection;import java.util.Date;import org.apache.ojb.broker.PersistenceBroker;import org.apache.ojb.broker.PersistenceBrokerException;import org.apache.ojb.broker.PersistenceBrokerFactory;import org.apache.ojb.broker.query.Criteria;import org.apache.ojb.broker.query.Query;import org.apache.ojb.broker.query.QueryByCriteria;import com.amandris.clients.service.vo.Buyer;import com.amandris.clients.service.vo.SellerService;import com.amandris.clients.util.Constant;import com.amandris.clients.util.exception.DataAccessErrorException;import com.amandris.clients.util.exception.DataDeleteErrorException;import com.amandris.clients.util.exception.DataUpdateErrorException;public class BuyerDAO{			public void setBuyer( Buyer buyer)  throws DataUpdateErrorException{		PersistenceBroker broker = null;			try{			broker = PersistenceBrokerFactory.defaultPersistenceBroker();			broker.beginTransaction();			broker.store( buyer);			broker.commitTransaction();		}catch (PersistenceBrokerException ex){			broker.abortTransaction();			throw new DataUpdateErrorException( Buyer.class.getName(), this.getClass().getName() + ".setBuyer()", ex);		}finally {			if (broker != null) {				broker.close();			}		}	}		public void deleteBuyer( Buyer buyer)  throws DataDeleteErrorException{		PersistenceBroker broker = null;				try{			broker = PersistenceBrokerFactory.defaultPersistenceBroker();			broker.beginTransaction();			broker.delete( buyer);			broker.commitTransaction();		}catch ( PersistenceBrokerException ex){			broker.abortTransaction();			ex.printStackTrace();			throw new DataDeleteErrorException( Buyer.class.getName(), this.getClass().getName() + ".deleteBuyer()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public Buyer getBuyerByLogin( String login) throws DataAccessErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;		try {			criteria.addEqualTo		( "login", 		login);			criteria.addNotEqualTo	( "id", 		new Integer( 0));						Query query = new QueryByCriteria( Buyer.class, criteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return ( Buyer)broker.getObjectByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( Buyer.class.getName(), this.getClass().getName() + ".getBuyerByLogin()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public Buyer getBuyerByEmail( String email) throws DataAccessErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;		try {			criteria.addEqualTo		( "email", 		email);			criteria.addNotEqualTo	( "id", 		new Integer( 0));						Query query = new QueryByCriteria( Buyer.class, criteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return ( Buyer)broker.getObjectByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( Buyer.class.getName(), this.getClass().getName() + ".getBuyerByEmail()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public Collection getBuyerToCensor() throws DataAccessErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;		try {			criteria.addNotEqualTo	( "id", 		new Integer( 0));			criteria.addEqualTo		( "textActive",	new Integer( 0));						Query query = new QueryByCriteria( Buyer.class, criteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return broker.getCollectionByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( Buyer.class.getName(), this.getClass().getName() + ".getBuyerToCensor()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public Collection getBuyerToCensorPicture() throws DataAccessErrorException	{		Criteria 			criteria		= new Criteria();		Criteria 			mainCriteria	= new Criteria();		Criteria			picture1Criteria = new Criteria();		Criteria			picture2Criteria = new Criteria();		Criteria			picture3Criteria = new Criteria();		Criteria			picture4Criteria = new Criteria();		Criteria			picture5Criteria = new Criteria();		PersistenceBroker 	broker 			= null;		try {			mainCriteria.addNotEqualTo	( "id", 				new Integer( 0));			picture1Criteria.addEqualTo	( "picture1Waiting",	new Integer( 1));			picture2Criteria.addEqualTo	( "picture2Waiting",	new Integer( 1));			picture3Criteria.addEqualTo	( "picture3Waiting",	new Integer( 1));			picture4Criteria.addEqualTo	( "picture4Waiting",	new Integer( 1));			picture5Criteria.addEqualTo	( "picture5Waiting",	new Integer( 1));						criteria.addOrCriteria( picture1Criteria);			criteria.addOrCriteria( picture2Criteria);			criteria.addOrCriteria( picture3Criteria);			criteria.addOrCriteria( picture4Criteria);			criteria.addOrCriteria( picture5Criteria);						mainCriteria.addAndCriteria( criteria);						Query query = new QueryByCriteria( Buyer.class, mainCriteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return broker.getCollectionByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( Buyer.class.getName(), this.getClass().getName() + ".getBuyerToCensorPicture()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public Buyer getBuyerByLoginAndPassword( String login, String password, boolean onlyActives) throws DataAccessErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;		try {			criteria.addEqualTo		( "login", 		login);			criteria.addEqualTo		( "password", 	password);			criteria.addNotEqualTo	( "id", 		new Integer( 0));						if (onlyActives == true){				criteria.addEqualTo( "active",new Integer( 1));			}						Query query = new QueryByCriteria( Buyer.class, criteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return ( Buyer)broker.getObjectByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( Buyer.class.getName(), this.getClass().getName() + ".getBuyerByLoginAndPassword()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public Buyer getBuyerByEmailAndPassword( String email, String password, boolean onlyActives) throws DataAccessErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;		try {			criteria.addEqualTo		( "email", 		email);			criteria.addEqualTo		( "password", 	password);			criteria.addNotEqualTo	( "id", 		new Integer( 0));						if (onlyActives == true){				criteria.addEqualTo( "active",new Integer( 1));			}						Query query = new QueryByCriteria( Buyer.class, criteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return ( Buyer)broker.getObjectByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( Buyer.class.getName(), this.getClass().getName() + ".getBuyerByEmailAndPassword()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public Buyer getBuyerById( Integer id, Boolean onlyPublic) throws DataAccessErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;				if( id.intValue() == 0)			return null;				try {			criteria.addEqualTo( "id", id);						if( onlyPublic != null){				if( onlyPublic.booleanValue() == true)					criteria.addEqualTo( "isPublic", new Integer( 1));				else					criteria.addEqualTo( "isPublic", new Integer( 0));			}						Query query = new QueryByCriteria( Buyer.class, criteria);			broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return ( Buyer) broker.getObjectByQuery(query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( Buyer.class.getName(), this.getClass().getName() + ".getBuyerById()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		private Criteria getBuyerPrepareQuery( 	Integer buyerSex, 											Integer country,											Integer state, 											Date 	birthDateLow, 											Date 	birthDateHigh, 											Integer origin,											Integer skinColor,											Integer hairColor,											Integer hairLength,											Integer eyeColor,											Integer language,											Integer educationLevel,											Integer smoker,											Integer physique,											Integer height,											Integer orientation,											Integer pennisSize,											Integer breastSize,											String login)	{			Criteria 	criteria		= new Criteria();		Criteria	mainCriteria 	= new Criteria();				mainCriteria.addNotEqualTo	( "id", new Integer( 0));		mainCriteria.addEqualTo		( "active", new Integer( 1));		mainCriteria.addEqualTo		( "isPublic", new Integer( 1));				if( state.intValue() != 0)			mainCriteria.addEqualTo( "stateId", state);		else if( country.intValue() != 0)			mainCriteria.addEqualTo( "countryId", country);				mainCriteria.addGreaterOrEqualThan	( "birthDate" , birthDateLow);		mainCriteria.addLessOrEqualThan		( "birthDate" , birthDateHigh);				// Busqueda por sexo del demandante				Criteria sellerSexCriteria = new Criteria();				if( ( buyerSex.intValue() & Constant.SEX_BOY) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "sexConst" , new Integer( Constant.SEX_BOY));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( buyerSex.intValue() & Constant.SEX_BOY_AND_GIRL_COUPLE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "sexConst" , new Integer( Constant.SEX_BOY_AND_GIRL_COUPLE));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( buyerSex.intValue() & Constant.SEX_BOYS_COUPLE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "sexConst" , new Integer( Constant.SEX_BOYS_COUPLE));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( buyerSex.intValue() & Constant.SEX_GIRL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "sexConst" , new Integer( Constant.SEX_GIRL));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( buyerSex.intValue() & Constant.SEX_GIRLS_COUPLE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "sexConst" , new Integer( Constant.SEX_GIRLS_COUPLE));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( buyerSex.intValue() & Constant.SEX_GROUP) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "sexConst" , new Integer( Constant.SEX_GROUP));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( buyerSex.intValue() & Constant.SEX_SHEMALE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "sexConst" , new Integer( Constant.SEX_SHEMALE));			sellerSexCriteria.addOrCriteria( criteria);		}				if( sellerSexCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( sellerSexCriteria);								//Búsqueda por origen				Criteria originCriteria = new Criteria();				if( ( origin.intValue() & Constant.ORIGIN_AFRICAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "originConst" , new Integer( Constant.ORIGIN_AFRICAN));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_ARABIAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "originConst" , new Integer( Constant.ORIGIN_ARABIAN));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_CAUCASIC) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "originConst" , new Integer( Constant.ORIGIN_CAUCASIC));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_HISPANIC) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "originConst" , new Integer( Constant.ORIGIN_HISPANIC));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_INDIAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "originConst" , new Integer( Constant.ORIGIN_INDIAN));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_MEDITERRANEAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "originConst" , new Integer( Constant.ORIGIN_MEDITERRANEAN));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_ORIENTAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "originConst" , new Integer( Constant.ORIGIN_ORIENTAL));			originCriteria.addOrCriteria( criteria);		}				if( originCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( originCriteria);						//Búsqueda por color de piel				Criteria skinColorCriteria = new Criteria();				if( ( skinColor.intValue() & Constant.SKIN_COLOR_BLACK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "skinColorConst" , new Integer( Constant.SKIN_COLOR_BLACK));			skinColorCriteria.addOrCriteria( criteria);		}		if( ( skinColor.intValue() & Constant.SKIN_COLOR_DARK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "skinColorConst" , new Integer( Constant.SKIN_COLOR_DARK));			skinColorCriteria.addOrCriteria( criteria);		}		if( ( skinColor.intValue() & Constant.SKIN_COLOR_VERY_DARK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "skinColorConst" , new Integer( Constant.SKIN_COLOR_VERY_DARK));			skinColorCriteria.addOrCriteria( criteria);		}		if( ( skinColor.intValue() & Constant.SKIN_COLOR_WHITE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "skinColorConst" , new Integer( Constant.SKIN_COLOR_WHITE));			skinColorCriteria.addOrCriteria( criteria);		}				if( skinColorCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( skinColorCriteria);						//Búsqueda por color de pelo				Criteria hairColorCriteria = new Criteria();				if( ( hairColor.intValue() & Constant.HAIR_COLOR_DARK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "hairColorConst" , new Integer( Constant.HAIR_COLOR_DARK));			hairColorCriteria.addOrCriteria( criteria);		}		if( ( hairColor.intValue() & Constant.HAIR_COLOR_BLONDE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "hairColorConst" , new Integer( Constant.HAIR_COLOR_BLONDE));			hairColorCriteria.addOrCriteria( criteria);		}		if( ( hairColor.intValue() & Constant.HAIR_COLOR_BROWN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "hairColorConst" , new Integer( Constant.HAIR_COLOR_BROWN));			hairColorCriteria.addOrCriteria( criteria);		}		if( ( hairColor.intValue() & Constant.HAIR_COLOR_RED) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "hairColorConst" , new Integer( Constant.HAIR_COLOR_RED));			hairColorCriteria.addOrCriteria( criteria);		}		if( ( hairColor.intValue() & Constant.HAIR_COLOR_WHITE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "hairColorConst" , new Integer( Constant.HAIR_COLOR_WHITE));			hairColorCriteria.addOrCriteria( criteria);		}				if( hairColorCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( hairColorCriteria);						//Búsqueda por longitud del pelo				Criteria hairLengthCriteria = new Criteria();				if( ( hairLength.intValue() & Constant.HAIR_LENGTH_BEYOND_SHOULDERS) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "hairLengthConst" , new Integer( Constant.HAIR_LENGTH_BEYOND_SHOULDERS));			hairLengthCriteria.addOrCriteria( criteria);		}		if( ( hairLength.intValue() & Constant.HAIR_LENGTH_NOT_HAIR) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "hairLengthConst" , new Integer( Constant.HAIR_LENGTH_NOT_HAIR));			hairLengthCriteria.addOrCriteria( criteria);		}		if( ( hairLength.intValue() & Constant.HAIR_LENGTH_SHORT) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "hairLengthConst" , new Integer( Constant.HAIR_LENGTH_SHORT));			hairLengthCriteria.addOrCriteria( criteria);		}		if( ( hairLength.intValue() & Constant.HAIR_LENGTH_UNTIL_NECK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "hairLengthConst" , new Integer( Constant.HAIR_LENGTH_UNTIL_NECK));			hairLengthCriteria.addOrCriteria( criteria);		}		if( ( hairLength.intValue() & Constant.HAIR_LENGTH_UNTIL_SHOULDERS) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "hairLengthConst" , new Integer( Constant.HAIR_LENGTH_UNTIL_SHOULDERS));			hairLengthCriteria.addOrCriteria( criteria);		}				if( hairLengthCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( hairLengthCriteria);								//Búsqueda por color de ojos				Criteria eyeColorCriteria = new Criteria();				if( ( eyeColor.intValue() & Constant.EYE_COLOR_BLACK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "eyeColorConst" , new Integer( Constant.EYE_COLOR_BLACK));			eyeColorCriteria.addOrCriteria( criteria);		}		if( ( eyeColor.intValue() & Constant.EYE_COLOR_BLUE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "eyeColorConst" , new Integer( Constant.EYE_COLOR_BLUE));			eyeColorCriteria.addOrCriteria( criteria);		}		if( ( eyeColor.intValue() & Constant.EYE_COLOR_BROWN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "eyeColorConst" , new Integer( Constant.EYE_COLOR_BROWN));			eyeColorCriteria.addOrCriteria( criteria);		}		if( ( eyeColor.intValue() & Constant.EYE_COLOR_GREEN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "eyeColorConst" , new Integer( Constant.EYE_COLOR_GREEN));			eyeColorCriteria.addOrCriteria( criteria);		}				if( eyeColorCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( eyeColorCriteria);				//Busqueda por idioma				Criteria languageCriteria = new Criteria();				if( ( language.intValue() & Constant.LANGUAGE_ARABIAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "language1Const" , new Integer( Constant.LANGUAGE_ARABIAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language2Const" , new Integer( Constant.LANGUAGE_ARABIAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language3Const" , new Integer( Constant.LANGUAGE_ARABIAN));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_CHINESSE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "language1Const" , new Integer( Constant.LANGUAGE_CHINESSE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language2Const" , new Integer( Constant.LANGUAGE_CHINESSE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language3Const" , new Integer( Constant.LANGUAGE_CHINESSE));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_ENGLISH) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "language1Const" , new Integer( Constant.LANGUAGE_ENGLISH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language2Const" , new Integer( Constant.LANGUAGE_ENGLISH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language3Const" , new Integer( Constant.LANGUAGE_ENGLISH));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_FRENCH) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "language1Const" , new Integer( Constant.LANGUAGE_FRENCH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language2Const" , new Integer( Constant.LANGUAGE_FRENCH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language3Const" , new Integer( Constant.LANGUAGE_FRENCH));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_GERMAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "language1Const" , new Integer( Constant.LANGUAGE_GERMAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language2Const" , new Integer( Constant.LANGUAGE_GERMAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language3Const" , new Integer( Constant.LANGUAGE_GERMAN));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_ITALIAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "language1Const" , new Integer( Constant.LANGUAGE_ITALIAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language2Const" , new Integer( Constant.LANGUAGE_ITALIAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language3Const" , new Integer( Constant.LANGUAGE_ITALIAN));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_JAPANESSE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "language1Const" , new Integer( Constant.LANGUAGE_JAPANESSE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language2Const" , new Integer( Constant.LANGUAGE_JAPANESSE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language3Const" , new Integer( Constant.LANGUAGE_JAPANESSE));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_PORTUGUESE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "language1Const" , new Integer( Constant.LANGUAGE_PORTUGUESE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language2Const" , new Integer( Constant.LANGUAGE_PORTUGUESE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language3Const" , new Integer( Constant.LANGUAGE_PORTUGUESE));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_SPANISH) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "language1Const" , new Integer( Constant.LANGUAGE_SPANISH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language2Const" , new Integer( Constant.LANGUAGE_SPANISH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "language3Const" , new Integer( Constant.LANGUAGE_SPANISH));			languageCriteria.addOrCriteria( criteria);		}				if( languageCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( languageCriteria);						//Búsqueda por nivel de estudios				Criteria educationLevelCriteria = new Criteria();				if( ( educationLevel.intValue() & Constant.EDUCATION_LEVEL_POSTDEGREE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "educationLevelConst" , new Integer( Constant.EDUCATION_LEVEL_POSTDEGREE));			educationLevelCriteria.addOrCriteria( criteria);		}		if( ( educationLevel.intValue() & Constant.EDUCATION_LEVEL_PRIMARY) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "educationLevelConst" , new Integer( Constant.EDUCATION_LEVEL_PRIMARY));			educationLevelCriteria.addOrCriteria( criteria);		}		if( ( educationLevel.intValue() & Constant.EDUCATION_LEVEL_SECONDARY) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "educationLevelConst" , new Integer( Constant.EDUCATION_LEVEL_SECONDARY));			educationLevelCriteria.addOrCriteria( criteria);		}		if( ( educationLevel.intValue() & Constant.EDUCATION_LEVEL_UNIVERSITARY) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "educationLevelConst" , new Integer( Constant.EDUCATION_LEVEL_UNIVERSITARY));			educationLevelCriteria.addOrCriteria( criteria);		}				if( educationLevelCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( educationLevelCriteria);						//Búsqueda por fumador				Criteria smokerCriteria = new Criteria();				if( ( smoker.intValue() & Constant.SMOKER_EVENTUALLY) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "smokerConst" , new Integer( Constant.SMOKER_EVENTUALLY));			smokerCriteria.addOrCriteria( criteria);		}		if( ( smoker.intValue() & Constant.SMOKER_NO) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "smokerConst" , new Integer( Constant.SMOKER_NO));			smokerCriteria.addOrCriteria( criteria);		}		if( ( smoker.intValue() & Constant.SMOKER_YES) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "smokerConst" , new Integer( Constant.SMOKER_YES));			smokerCriteria.addOrCriteria( criteria);		}				if( smokerCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( smokerCriteria);						//Búsqueda por físico				Criteria physiqueCriteria = new Criteria();				if( ( physique.intValue() & Constant.PHYSIQUE_ATLETHIC) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "physiqueConst" , new Integer( Constant.PHYSIQUE_ATLETHIC));			physiqueCriteria.addOrCriteria( criteria);		}		if( ( physique.intValue() & Constant.PHYSIQUE_FAT) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "physiqueConst" , new Integer( Constant.PHYSIQUE_FAT));			physiqueCriteria.addOrCriteria( criteria);		}		if( ( physique.intValue() & Constant.PHYSIQUE_MUSCLED) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "physiqueConst" , new Integer( Constant.PHYSIQUE_MUSCLED));			physiqueCriteria.addOrCriteria( criteria);		}		if( ( physique.intValue() & Constant.PHYSIQUE_NORMAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "physiqueConst" , new Integer( Constant.PHYSIQUE_NORMAL));			physiqueCriteria.addOrCriteria( criteria);		}		if( ( physique.intValue() & Constant.PHYSIQUE_THIN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "physiqueConst" , new Integer( Constant.PHYSIQUE_THIN));			physiqueCriteria.addOrCriteria( criteria);		}				if( physiqueCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( physiqueCriteria);						//Búsqueda por altura				Criteria heightCriteria = new Criteria();				if( ( height.intValue() & Constant.HEIGHT_BETWEEN_150_AND_159) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "heightConst" , new Integer( Constant.HEIGHT_BETWEEN_150_AND_159));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_BETWEEN_160_AND_169) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "heightConst" , new Integer( Constant.HEIGHT_BETWEEN_160_AND_169));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_BETWEEN_170_AND_179) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "heightConst" , new Integer( Constant.HEIGHT_BETWEEN_170_AND_179));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_BETWEEN_180_AND_189) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "heightConst" , new Integer( Constant.HEIGHT_BETWEEN_180_AND_189));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_BETWEEN_190_AND_200) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "heightConst" , new Integer( Constant.HEIGHT_BETWEEN_190_AND_200));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_LESS_THAN_150) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "heightConst" , new Integer( Constant.HEIGHT_LESS_THAN_150));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_MORE_THAN_200) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "heightConst" , new Integer( Constant.HEIGHT_MORE_THAN_200));			heightCriteria.addOrCriteria( criteria);		}				if( heightCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( heightCriteria);						//Búsqueda por orientacion sexual				Criteria orientationCriteria = new Criteria();				if( ( orientation.intValue() & Constant.ORIENTATION_BICURIOUS) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "orientationConst" , new Integer( Constant.ORIENTATION_BICURIOUS));			orientationCriteria.addOrCriteria( criteria);		}		if( ( orientation.intValue() & Constant.ORIENTATION_BISEXUAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "orientationConst" , new Integer( Constant.ORIENTATION_BISEXUAL));			orientationCriteria.addOrCriteria( criteria);		}		if( ( orientation.intValue() & Constant.ORIENTATION_HETEROSEXUAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "orientationConst" , new Integer( Constant.ORIENTATION_HETEROSEXUAL));			orientationCriteria.addOrCriteria( criteria);		}		if( ( orientation.intValue() & Constant.ORIENTATION_HOMOSEXUAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "orientationConst" , new Integer( Constant.ORIENTATION_HOMOSEXUAL));			orientationCriteria.addOrCriteria( criteria);		}				if( orientationCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( orientationCriteria);						//Búsqueda por tamaño del pene				Criteria pennisSizeCriteria = new Criteria();				if( ( pennisSize.intValue() & Constant.PENNIS_SIZE_BIG) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "pennisSizeConst" , new Integer( Constant.PENNIS_SIZE_BIG));			pennisSizeCriteria.addOrCriteria( criteria);		}		if( ( pennisSize.intValue() & Constant.PENNIS_SIZE_BIGGER_THAN_NORMAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "pennisSizeConst" , new Integer( Constant.PENNIS_SIZE_BIGGER_THAN_NORMAL));			pennisSizeCriteria.addOrCriteria( criteria);		}		if( ( pennisSize.intValue() & Constant.PENNIS_SIZE_NORMAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "pennisSizeConst" , new Integer( Constant.PENNIS_SIZE_NORMAL));			pennisSizeCriteria.addOrCriteria( criteria);		}		if( ( pennisSize.intValue() & Constant.PENNIS_SIZE_VERY_BIG) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "pennisSizeConst" , new Integer( Constant.PENNIS_SIZE_VERY_BIG));			pennisSizeCriteria.addOrCriteria( criteria);		}				if( pennisSizeCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( pennisSizeCriteria);						//Busqueda por tamaño de los pechos				Criteria breastSizeCriteria = new Criteria();				if( ( breastSize.intValue() & Constant.BREAST_SIZE_BIG) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "breastSizeConst" , new Integer( Constant.BREAST_SIZE_BIG));			breastSizeCriteria.addOrCriteria( criteria);		}		if( ( breastSize.intValue() & Constant.BREAST_SIZE_NORMAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "breastSizeConst" , new Integer( Constant.BREAST_SIZE_NORMAL));			breastSizeCriteria.addOrCriteria( criteria);		}		if( ( breastSize.intValue() & Constant.BREAST_SIZE_SMALL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "breastSizeConst" , new Integer( Constant.BREAST_SIZE_SMALL));			breastSizeCriteria.addOrCriteria( criteria);		}		if( ( breastSize.intValue() & Constant.BREAST_SIZE_VERY_BIG) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "breastSizeConst" , new Integer( Constant.BREAST_SIZE_VERY_BIG));			breastSizeCriteria.addOrCriteria( criteria);		}				if( breastSizeCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( breastSizeCriteria);						if( !login.equals( ""))			mainCriteria.addLike( "login", "%" + login + "%");				return mainCriteria;	}		public Collection getBuyer( Integer buyerSex, 								Integer country,								Integer state, 								Date 	birthDateLow, 								Date 	birthDateHigh, 								Integer origin,								Integer skinColor,								Integer hairColor,								Integer hairLength,								Integer eyeColor,								Integer language,								Integer educationLevel,								Integer smoker,								Integer physique,								Integer height,								Integer orientation,								Integer pennisSize,								Integer breastSize,								String	login,								String orderedBy,								int startIndex,								int offset) throws DataAccessErrorException	{		PersistenceBroker 	broker 			= null;		Criteria			mainCriteria	= null;				mainCriteria = getBuyerPrepareQuery( 	buyerSex, 												country, 												state, 												birthDateLow, 												birthDateHigh, 												origin, 												skinColor, 												hairColor,												hairLength,												eyeColor,												language,												educationLevel,												smoker,												physique,												height,												orientation,												pennisSize,												breastSize,												login);				try{			QueryByCriteria query = new QueryByCriteria( Buyer.class, mainCriteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();						if( orderedBy.equals( "login"))				query.addOrderBy( orderedBy, true);			else 				query.addOrderBy( orderedBy, false);									query.setStartAtIndex( startIndex);			query.setEndAtIndex( startIndex + offset -1);						return broker.getCollectionByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( SellerService.class.getName(), this.getClass().getName() + ".getBuyer()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public int getBuyerCount( 	Integer buyerSex, 								Integer country,								Integer state, 								Date 	birthDateLow, 								Date 	birthDateHigh, 								Integer origin,								Integer skinColor,								Integer hairColor,								Integer hairLength,								Integer eyeColor,								Integer language,								Integer educationLevel,								Integer smoker,								Integer physique,								Integer height,								Integer orientation,								Integer pennisSize,								Integer breastSize,								String login) throws DataAccessErrorException	{		PersistenceBroker 	broker 			= null;		Criteria			mainCriteria	= null;				mainCriteria = getBuyerPrepareQuery( 	buyerSex, 												country, 												state, 												birthDateLow, 												birthDateHigh, 												origin, 												skinColor, 												hairColor,												hairLength,												eyeColor,												language,												educationLevel,												smoker,												physique,												height,												orientation,												pennisSize,												breastSize,												login);				try{			QueryByCriteria query = new QueryByCriteria( Buyer.class, mainCriteria);									broker = PersistenceBrokerFactory.defaultPersistenceBroker();						return broker.getCount( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( SellerService.class.getName(), this.getClass().getName() + ".getBuyerCount()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}}