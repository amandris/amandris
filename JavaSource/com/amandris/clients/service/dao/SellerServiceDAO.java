package com.amandris.clients.service.dao;import java.util.Calendar;import java.util.Date;import java.util.Collection;import org.apache.ojb.broker.PersistenceBroker;import org.apache.ojb.broker.PersistenceBrokerException;import org.apache.ojb.broker.PersistenceBrokerFactory;import org.apache.ojb.broker.query.Criteria;import org.apache.ojb.broker.query.Query;import org.apache.ojb.broker.query.QueryByCriteria;import com.amandris.clients.service.vo.SellerMessage;import com.amandris.clients.service.vo.SellerService;import com.amandris.clients.util.Constant;import com.amandris.clients.util.exception.DataAccessErrorException;import com.amandris.clients.util.exception.DataDeleteErrorException;import com.amandris.clients.util.exception.DataUpdateErrorException;public class SellerServiceDAO{		public void setSellerService( SellerService sellerService)  throws DataUpdateErrorException{		PersistenceBroker broker = null;			try{			broker = PersistenceBrokerFactory.defaultPersistenceBroker();			broker.beginTransaction();			broker.store( sellerService);			broker.commitTransaction();		}catch (PersistenceBrokerException ex){			broker.abortTransaction();			throw new DataUpdateErrorException( SellerService.class.getName(), this.getClass().getName() + ".setSellerService()", ex);		}finally {			if (broker != null) {				broker.close();			}		}	}		public void deleteSellerService( SellerService sellerService) throws DataDeleteErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;				try {			broker = PersistenceBrokerFactory.defaultPersistenceBroker();						broker.beginTransaction();			broker.delete( sellerService);			broker.commitTransaction();					} catch ( PersistenceBrokerException ex) {			throw new DataDeleteErrorException( SellerService.class.getName(), this.getClass().getName() + ".deleteSellerService()", ex);		} finally {			if ( broker != null) {				broker.close();			}		}	}		public void deleteSellerServiceBySellerId( Integer sellerId) throws DataDeleteErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;				try {			criteria.addNotEqualTo	( "id", new Integer( 0));			criteria.addEqualTo		( "sellerId", sellerId);									QueryByCriteria query = new QueryByCriteria( SellerService.class, criteria);									broker = PersistenceBrokerFactory.defaultPersistenceBroker();				broker.deleteByQuery( query);					}catch ( PersistenceBrokerException ex) {			throw new DataDeleteErrorException( SellerService.class.getName(), this.getClass().getName() + ".deleteSellerServiceBySellerId()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public SellerService getSellerServiceBySellerIdServiceTypeAndSex( Integer sellerId, Integer serviceType, Integer sex) throws DataAccessErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;				if( ( sellerId.intValue() == 0) || ( serviceType.intValue() == 0) || ( sex.intValue() == 0))			return null;				try {			criteria.addEqualTo		( "sellerId",			sellerId);			criteria.addEqualTo		( "serviceTypeConst",	serviceType);			criteria.addEqualTo		( "sexConst",			sex);			criteria.addNotEqualTo	( "id",					new Integer( 0));						Query query = new QueryByCriteria( SellerService.class, criteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return ( SellerService) broker.getObjectByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( SellerService.class.getName(), this.getClass().getName() + ".getSellerServiceBySellerIdServiceTypeAndSex()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public Collection getSellerServiceBySellerId( Integer sellerId) throws DataAccessErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;		try {			criteria.addEqualTo		( "sellerId",	sellerId);			criteria.addNotEqualTo	( "id",			new Integer( 0));						Query query = new QueryByCriteria( SellerService.class, criteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return broker.getCollectionByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( SellerService.class.getName(), this.getClass().getName() + ".getSellerServiceByBuyerId()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public Collection getSellerServiceBySellerIdAndServiceType( Integer sellerId, Integer serviceType) throws DataAccessErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;		try {			criteria.addEqualTo		( "sellerId",			sellerId);			criteria.addNotEqualTo	( "id",					new Integer( 0));			criteria.addEqualTo		( "serviceTypeConst",	serviceType);						Query query = new QueryByCriteria( SellerService.class, criteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return broker.getCollectionByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( SellerService.class.getName(), this.getClass().getName() + ".getSellerServiceByBuyerIdAndServiceType()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}		public SellerService getSellerServiceBySellerIdServiceTypeAndBuyerSex( Integer sellerId, Integer serviceType, Integer buyerSex) throws DataAccessErrorException	{		Criteria 			criteria	= new Criteria();		PersistenceBroker 	broker 		= null;		try {			criteria.addNotEqualTo	( "id",					new Integer( 0));			criteria.addEqualTo		( "sellerId",			sellerId);			criteria.addEqualTo		( "sexConst",			buyerSex);			criteria.addEqualTo		( "serviceTypeConst",	serviceType);						Query query = new QueryByCriteria( SellerService.class, criteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();				return ( SellerService) broker.getObjectByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( SellerService.class.getName(), this.getClass().getName() + ".getSellerServiceByBuyerIdAndBuyerSex()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}					private Criteria getSellerServicePrepareQuery( 	Integer buyerSex, 													Integer sellerSex,													Integer country,													Integer state, 													Date 	birthDateLow, 													Date 	birthDateHigh, 													Integer service,													Integer companyWithoutSexPriceHigh,													Integer companyWithSexPriceHigh,													Integer sexPriceHigh,													Integer eroticShowPriceHigh,													Integer origin,													Integer skinColor,													Integer hairColor,													Integer hairLength,													Integer eyeColor,													Integer language,													Integer educationLevel,													Integer smoker,													Integer physique,													Integer height,													Integer orientation,													Integer pennisSize,													Integer breastSize,													boolean	firstPlaceInSearch,													boolean isOnline,													boolean isFreeContact,													boolean hasAlbum,													String login)	{				Criteria 			criteria		= new Criteria();		Criteria			mainCriteria 	= new Criteria();		mainCriteria.addNotEqualTo	( "seller.id", new Integer( 0));		mainCriteria.addNotEqualTo	( "id", new Integer( 0));		mainCriteria.addEqualTo		( "seller.active", new Integer( 1));		if( buyerSex.intValue() != 0)			mainCriteria.addEqualTo( "sexConst", buyerSex);		if( state.intValue() != 0)			mainCriteria.addEqualTo( "seller.stateId", state);		else if( country.intValue() != 0)			mainCriteria.addEqualTo( "seller.countryId", country);		mainCriteria.addGreaterOrEqualThan	( "seller.birthDate" , birthDateLow);		mainCriteria.addLessOrEqualThan		( "seller.birthDate" , birthDateHigh);		// Busqueda por sexo del ofertante				Criteria sellerSexCriteria = new Criteria();				if( ( sellerSex.intValue() & Constant.SEX_BOY) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.sexConst" , new Integer( Constant.SEX_BOY));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( sellerSex.intValue() & Constant.SEX_BOY_AND_GIRL_COUPLE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.sexConst" , new Integer( Constant.SEX_BOY_AND_GIRL_COUPLE));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( sellerSex.intValue() & Constant.SEX_BOYS_COUPLE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.sexConst" , new Integer( Constant.SEX_BOYS_COUPLE));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( sellerSex.intValue() & Constant.SEX_GIRL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.sexConst" , new Integer( Constant.SEX_GIRL));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( sellerSex.intValue() & Constant.SEX_GIRLS_COUPLE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.sexConst" , new Integer( Constant.SEX_GIRLS_COUPLE));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( sellerSex.intValue() & Constant.SEX_GROUP) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.sexConst" , new Integer( Constant.SEX_GROUP));			sellerSexCriteria.addOrCriteria( criteria);		}		if( ( sellerSex.intValue() & Constant.SEX_SHEMALE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.sexConst" , new Integer( Constant.SEX_SHEMALE));			sellerSexCriteria.addOrCriteria( criteria);		}				if( sellerSexCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( sellerSexCriteria);						//Busqueda por tipo de servicio				Criteria serviceTypeCriteria = new Criteria();				if( ( service.intValue() & Constant.SERVICE_TYPE_COMPANY_WITH_SEX) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "serviceTypeConst" , new Integer( Constant.SERVICE_TYPE_COMPANY_WITH_SEX));			criteria.addLessOrEqualThan( "serviceFirstHourPrice", companyWithSexPriceHigh);			serviceTypeCriteria.addOrCriteria( criteria);		}				if( ( service.intValue() & Constant.SERVICE_TYPE_COMPANY_WITHOUT_SEX) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "serviceTypeConst" , new Integer( Constant.SERVICE_TYPE_COMPANY_WITHOUT_SEX));			criteria.addLessOrEqualThan( "serviceFirstHourPrice", companyWithoutSexPriceHigh);			serviceTypeCriteria.addOrCriteria( criteria);		}				if( ( service.intValue() & Constant.SERVICE_TYPE_SEX) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "serviceTypeConst" , new Integer( Constant.SERVICE_TYPE_SEX));			criteria.addLessOrEqualThan( "serviceFirstHourPrice", sexPriceHigh);			serviceTypeCriteria.addOrCriteria( criteria);		}				if( ( service.intValue() & Constant.SERVICE_TYPE_EROTIC_SHOW) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "serviceTypeConst" , new Integer( Constant.SERVICE_TYPE_EROTIC_SHOW));			criteria.addLessOrEqualThan( "serviceFirstHourPrice", eroticShowPriceHigh);			serviceTypeCriteria.addOrCriteria( criteria);		}				if( serviceTypeCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( serviceTypeCriteria);						//Búsqueda por origen				Criteria originCriteria = new Criteria();				if( ( origin.intValue() & Constant.ORIGIN_AFRICAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.originConst" , new Integer( Constant.ORIGIN_AFRICAN));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_ARABIAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.originConst" , new Integer( Constant.ORIGIN_ARABIAN));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_CAUCASIC) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.originConst" , new Integer( Constant.ORIGIN_CAUCASIC));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_HISPANIC) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.originConst" , new Integer( Constant.ORIGIN_HISPANIC));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_INDIAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.originConst" , new Integer( Constant.ORIGIN_INDIAN));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_MEDITERRANEAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.originConst" , new Integer( Constant.ORIGIN_MEDITERRANEAN));			originCriteria.addOrCriteria( criteria);		}		if( ( origin.intValue() & Constant.ORIGIN_ORIENTAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.originConst" , new Integer( Constant.ORIGIN_ORIENTAL));			originCriteria.addOrCriteria( criteria);		}				if( originCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( originCriteria);				//Búsqueda por color de piel				Criteria skinColorCriteria = new Criteria();				if( ( skinColor.intValue() & Constant.SKIN_COLOR_BLACK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.skinColorConst" , new Integer( Constant.SKIN_COLOR_BLACK));			skinColorCriteria.addOrCriteria( criteria);		}		if( ( skinColor.intValue() & Constant.SKIN_COLOR_DARK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.skinColorConst" , new Integer( Constant.SKIN_COLOR_DARK));			skinColorCriteria.addOrCriteria( criteria);		}		if( ( skinColor.intValue() & Constant.SKIN_COLOR_VERY_DARK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.skinColorConst" , new Integer( Constant.SKIN_COLOR_VERY_DARK));			skinColorCriteria.addOrCriteria( criteria);		}		if( ( skinColor.intValue() & Constant.SKIN_COLOR_WHITE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.skinColorConst" , new Integer( Constant.SKIN_COLOR_WHITE));			skinColorCriteria.addOrCriteria( criteria);		}				if( skinColorCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( skinColorCriteria);						//Búsqueda por color de pelo				Criteria hairColorCriteria = new Criteria();				if( ( hairColor.intValue() & Constant.HAIR_COLOR_DARK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.hairColorConst" , new Integer( Constant.HAIR_COLOR_DARK));			hairColorCriteria.addOrCriteria( criteria);		}		if( ( hairColor.intValue() & Constant.HAIR_COLOR_BLONDE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.hairColorConst" , new Integer( Constant.HAIR_COLOR_BLONDE));			hairColorCriteria.addOrCriteria( criteria);		}		if( ( hairColor.intValue() & Constant.HAIR_COLOR_BROWN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.hairColorConst" , new Integer( Constant.HAIR_COLOR_BROWN));			hairColorCriteria.addOrCriteria( criteria);		}		if( ( hairColor.intValue() & Constant.HAIR_COLOR_RED) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.hairColorConst" , new Integer( Constant.HAIR_COLOR_RED));			hairColorCriteria.addOrCriteria( criteria);		}		if( ( hairColor.intValue() & Constant.HAIR_COLOR_WHITE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.hairColorConst" , new Integer( Constant.HAIR_COLOR_WHITE));			hairColorCriteria.addOrCriteria( criteria);		}				if( hairColorCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( hairColorCriteria);						//Búsqueda por longitud del pelo				Criteria hairLengthCriteria = new Criteria();				if( ( hairLength.intValue() & Constant.HAIR_LENGTH_BEYOND_SHOULDERS) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.hairLengthConst" , new Integer( Constant.HAIR_LENGTH_BEYOND_SHOULDERS));			hairLengthCriteria.addOrCriteria( criteria);		}		if( ( hairLength.intValue() & Constant.HAIR_LENGTH_NOT_HAIR) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.hairLengthConst" , new Integer( Constant.HAIR_LENGTH_NOT_HAIR));			hairLengthCriteria.addOrCriteria( criteria);		}		if( ( hairLength.intValue() & Constant.HAIR_LENGTH_SHORT) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.hairLengthConst" , new Integer( Constant.HAIR_LENGTH_SHORT));			hairLengthCriteria.addOrCriteria( criteria);		}		if( ( hairLength.intValue() & Constant.HAIR_LENGTH_UNTIL_NECK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.hairLengthConst" , new Integer( Constant.HAIR_LENGTH_UNTIL_NECK));			hairLengthCriteria.addOrCriteria( criteria);		}		if( ( hairLength.intValue() & Constant.HAIR_LENGTH_UNTIL_SHOULDERS) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.hairLengthConst" , new Integer( Constant.HAIR_LENGTH_UNTIL_SHOULDERS));			hairLengthCriteria.addOrCriteria( criteria);		}				if( hairLengthCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( hairLengthCriteria);								//Búsqueda por color de ojos				Criteria eyeColorCriteria = new Criteria();				if( ( eyeColor.intValue() & Constant.EYE_COLOR_BLACK) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.eyeColorConst" , new Integer( Constant.EYE_COLOR_BLACK));			eyeColorCriteria.addOrCriteria( criteria);		}		if( ( eyeColor.intValue() & Constant.EYE_COLOR_BLUE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.eyeColorConst" , new Integer( Constant.EYE_COLOR_BLUE));			eyeColorCriteria.addOrCriteria( criteria);		}		if( ( eyeColor.intValue() & Constant.EYE_COLOR_BROWN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.eyeColorConst" , new Integer( Constant.EYE_COLOR_BROWN));			eyeColorCriteria.addOrCriteria( criteria);		}		if( ( eyeColor.intValue() & Constant.EYE_COLOR_GREEN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.eyeColorConst" , new Integer( Constant.EYE_COLOR_GREEN));			eyeColorCriteria.addOrCriteria( criteria);		}			if( eyeColorCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( eyeColorCriteria);				//Busqueda por idioma		Criteria languageCriteria = new Criteria();				if( ( language.intValue() & Constant.LANGUAGE_ARABIAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.language1Const" , new Integer( Constant.LANGUAGE_ARABIAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language2Const" , new Integer( Constant.LANGUAGE_ARABIAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language3Const" , new Integer( Constant.LANGUAGE_ARABIAN));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_CHINESSE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.language1Const" , new Integer( Constant.LANGUAGE_CHINESSE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language2Const" , new Integer( Constant.LANGUAGE_CHINESSE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language3Const" , new Integer( Constant.LANGUAGE_CHINESSE));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_ENGLISH) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.language1Const" , new Integer( Constant.LANGUAGE_ENGLISH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language2Const" , new Integer( Constant.LANGUAGE_ENGLISH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language3Const" , new Integer( Constant.LANGUAGE_ENGLISH));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_FRENCH) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.language1Const" , new Integer( Constant.LANGUAGE_FRENCH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language2Const" , new Integer( Constant.LANGUAGE_FRENCH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language3Const" , new Integer( Constant.LANGUAGE_FRENCH));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_GERMAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.language1Const" , new Integer( Constant.LANGUAGE_GERMAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language2Const" , new Integer( Constant.LANGUAGE_GERMAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language3Const" , new Integer( Constant.LANGUAGE_GERMAN));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_ITALIAN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.language1Const" , new Integer( Constant.LANGUAGE_ITALIAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language2Const" , new Integer( Constant.LANGUAGE_ITALIAN));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language3Const" , new Integer( Constant.LANGUAGE_ITALIAN));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_JAPANESSE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.language1Const" , new Integer( Constant.LANGUAGE_JAPANESSE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language2Const" , new Integer( Constant.LANGUAGE_JAPANESSE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language3Const" , new Integer( Constant.LANGUAGE_JAPANESSE));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_PORTUGUESE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.language1Const" , new Integer( Constant.LANGUAGE_PORTUGUESE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language2Const" , new Integer( Constant.LANGUAGE_PORTUGUESE));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language3Const" , new Integer( Constant.LANGUAGE_PORTUGUESE));			languageCriteria.addOrCriteria( criteria);		}		if( ( language.intValue() & Constant.LANGUAGE_SPANISH) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.language1Const" , new Integer( Constant.LANGUAGE_SPANISH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language2Const" , new Integer( Constant.LANGUAGE_SPANISH));			languageCriteria.addOrCriteria( criteria);			criteria = new Criteria();			criteria.addEqualTo( "seller.language3Const" , new Integer( Constant.LANGUAGE_SPANISH));			languageCriteria.addOrCriteria( criteria);		}				if( languageCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( languageCriteria);							//Búsqueda por nivel de estudios				Criteria educationLevelCriteria = new Criteria();				if( ( educationLevel.intValue() & Constant.EDUCATION_LEVEL_POSTDEGREE) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.educationLevelConst" , new Integer( Constant.EDUCATION_LEVEL_POSTDEGREE));			educationLevelCriteria.addOrCriteria( criteria);		}		if( ( educationLevel.intValue() & Constant.EDUCATION_LEVEL_PRIMARY) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.educationLevelConst" , new Integer( Constant.EDUCATION_LEVEL_PRIMARY));			educationLevelCriteria.addOrCriteria( criteria);		}		if( ( educationLevel.intValue() & Constant.EDUCATION_LEVEL_SECONDARY) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.educationLevelConst" , new Integer( Constant.EDUCATION_LEVEL_SECONDARY));			educationLevelCriteria.addOrCriteria( criteria);		}		if( ( educationLevel.intValue() & Constant.EDUCATION_LEVEL_UNIVERSITARY) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.educationLevelConst" , new Integer( Constant.EDUCATION_LEVEL_UNIVERSITARY));			educationLevelCriteria.addOrCriteria( criteria);		}				if( educationLevelCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( educationLevelCriteria);						//Búsqueda por fumador				Criteria smokerCriteria = new Criteria();				if( ( smoker.intValue() & Constant.SMOKER_EVENTUALLY) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.smokerConst" , new Integer( Constant.SMOKER_EVENTUALLY));			smokerCriteria.addOrCriteria( criteria);		}		if( ( smoker.intValue() & Constant.SMOKER_NO) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.smokerConst" , new Integer( Constant.SMOKER_NO));			smokerCriteria.addOrCriteria( criteria);		}		if( ( smoker.intValue() & Constant.SMOKER_YES) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.smokerConst" , new Integer( Constant.SMOKER_YES));			smokerCriteria.addOrCriteria( criteria);		}				if( smokerCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( smokerCriteria);						//Búsqueda por físico				Criteria physiqueCriteria = new Criteria();				if( ( physique.intValue() & Constant.PHYSIQUE_ATLETHIC) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.physiqueConst" , new Integer( Constant.PHYSIQUE_ATLETHIC));			physiqueCriteria.addOrCriteria( criteria);		}		if( ( physique.intValue() & Constant.PHYSIQUE_FAT) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.physiqueConst" , new Integer( Constant.PHYSIQUE_FAT));			physiqueCriteria.addOrCriteria( criteria);		}		if( ( physique.intValue() & Constant.PHYSIQUE_MUSCLED) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.physiqueConst" , new Integer( Constant.PHYSIQUE_MUSCLED));			physiqueCriteria.addOrCriteria( criteria);		}		if( ( physique.intValue() & Constant.PHYSIQUE_NORMAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.physiqueConst" , new Integer( Constant.PHYSIQUE_NORMAL));			physiqueCriteria.addOrCriteria( criteria);		}		if( ( physique.intValue() & Constant.PHYSIQUE_THIN) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.physiqueConst" , new Integer( Constant.PHYSIQUE_THIN));			physiqueCriteria.addOrCriteria( criteria);		}				if( physiqueCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( physiqueCriteria);						//Búsqueda por altura				Criteria heightCriteria = new Criteria();				if( ( height.intValue() & Constant.HEIGHT_BETWEEN_150_AND_159) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.heightConst" , new Integer( Constant.HEIGHT_BETWEEN_150_AND_159));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_BETWEEN_160_AND_169) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.heightConst" , new Integer( Constant.HEIGHT_BETWEEN_160_AND_169));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_BETWEEN_170_AND_179) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.heightConst" , new Integer( Constant.HEIGHT_BETWEEN_170_AND_179));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_BETWEEN_180_AND_189) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.heightConst" , new Integer( Constant.HEIGHT_BETWEEN_180_AND_189));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_BETWEEN_190_AND_200) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.heightConst" , new Integer( Constant.HEIGHT_BETWEEN_190_AND_200));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_LESS_THAN_150) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.heightConst" , new Integer( Constant.HEIGHT_LESS_THAN_150));			heightCriteria.addOrCriteria( criteria);		}		if( ( height.intValue() & Constant.HEIGHT_MORE_THAN_200) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.heightConst" , new Integer( Constant.HEIGHT_MORE_THAN_200));			heightCriteria.addOrCriteria( criteria);		}				if( heightCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( heightCriteria);						//Búsqueda por orientacion sexual				Criteria orientationCriteria = new Criteria();				if( ( orientation.intValue() & Constant.ORIENTATION_BICURIOUS) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.orientationConst" , new Integer( Constant.ORIENTATION_BICURIOUS));			orientationCriteria.addOrCriteria( criteria);		}		if( ( orientation.intValue() & Constant.ORIENTATION_BISEXUAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.orientationConst" , new Integer( Constant.ORIENTATION_BISEXUAL));			orientationCriteria.addOrCriteria( criteria);		}		if( ( orientation.intValue() & Constant.ORIENTATION_HETEROSEXUAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.orientationConst" , new Integer( Constant.ORIENTATION_HETEROSEXUAL));			orientationCriteria.addOrCriteria( criteria);		}		if( ( orientation.intValue() & Constant.ORIENTATION_HOMOSEXUAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.orientationConst" , new Integer( Constant.ORIENTATION_HOMOSEXUAL));			orientationCriteria.addOrCriteria( criteria);		}				if( orientationCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( orientationCriteria);						//Búsqueda por tamaño del pene				Criteria pennisSizeCriteria = new Criteria();				if( ( pennisSize.intValue() & Constant.PENNIS_SIZE_BIG) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.pennisSizeConst" , new Integer( Constant.PENNIS_SIZE_BIG));			pennisSizeCriteria.addOrCriteria( criteria);		}		if( ( pennisSize.intValue() & Constant.PENNIS_SIZE_BIGGER_THAN_NORMAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.pennisSizeConst" , new Integer( Constant.PENNIS_SIZE_BIGGER_THAN_NORMAL));			pennisSizeCriteria.addOrCriteria( criteria);		}		if( ( pennisSize.intValue() & Constant.PENNIS_SIZE_NORMAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.pennisSizeConst" , new Integer( Constant.PENNIS_SIZE_NORMAL));			pennisSizeCriteria.addOrCriteria( criteria);		}		if( ( pennisSize.intValue() & Constant.PENNIS_SIZE_VERY_BIG) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.pennisSizeConst" , new Integer( Constant.PENNIS_SIZE_VERY_BIG));			pennisSizeCriteria.addOrCriteria( criteria);		}				if( pennisSizeCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( pennisSizeCriteria);						//Busqueda por tamaño de los pechos				Criteria breastSizeCriteria = new Criteria();				if( ( breastSize.intValue() & Constant.BREAST_SIZE_BIG) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.breastSizeConst" , new Integer( Constant.BREAST_SIZE_BIG));			breastSizeCriteria.addOrCriteria( criteria);		}		if( ( breastSize.intValue() & Constant.BREAST_SIZE_NORMAL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.breastSizeConst" , new Integer( Constant.BREAST_SIZE_NORMAL));			breastSizeCriteria.addOrCriteria( criteria);		}		if( ( breastSize.intValue() & Constant.BREAST_SIZE_SMALL) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.breastSizeConst" , new Integer( Constant.BREAST_SIZE_SMALL));			breastSizeCriteria.addOrCriteria( criteria);		}		if( ( breastSize.intValue() & Constant.BREAST_SIZE_VERY_BIG) != 0) {			criteria = new Criteria();			criteria.addEqualTo( "seller.breastSizeConst" , new Integer( Constant.BREAST_SIZE_VERY_BIG));			breastSizeCriteria.addOrCriteria( criteria);		}				if( breastSizeCriteria.isEmpty() == false)			mainCriteria.addAndCriteria( breastSizeCriteria);		if( isOnline)			mainCriteria.addEqualTo( "seller.isOnLine", new Integer( 1));				if( isFreeContact)			mainCriteria.addGreaterOrEqualThan( "seller.freeContactsUntil", Calendar.getInstance().getTime());				if( firstPlaceInSearch) 			mainCriteria.addGreaterOrEqualThan( "seller.firstPlaceInSearchUntil", Calendar.getInstance().getTime());				if( hasAlbum)			mainCriteria.addEqualTo( "seller.hasAlbum", new Integer( 1));				if( !login.equals( ""))			mainCriteria.addLike( "seller.login", "%" + login + "%");				return mainCriteria;	}		public Collection getSellerService( Integer buyerSex, 										Integer sellerSex,										Integer country,										Integer state, 										Date 	birthDateLow, 										Date 	birthDateHigh, 										Integer service,										Integer companyWithoutSexPriceHigh,										Integer companyWithSexPriceHigh,										Integer sexPriceHigh,										Integer eroticShowPriceHigh,										Integer origin,										Integer skinColor,										Integer hairColor,										Integer hairLength,										Integer eyeColor,										Integer language,										Integer educationLevel,										Integer smoker,										Integer physique,										Integer height,										Integer orientation,										Integer pennisSize,										Integer breastSize,										boolean firstPlaceInSearch,										boolean isOnline,										boolean isFreeContact,										boolean hasAlbum,										String	login,										String orderedBy,										int startIndex,										int offset) throws DataAccessErrorException	{		PersistenceBroker 	broker 			= null;		Criteria			mainCriteria	= null;				mainCriteria = getSellerServicePrepareQuery( 	buyerSex, 														sellerSex, 														country, 														state, 														birthDateLow, 														birthDateHigh, 														service, 														companyWithoutSexPriceHigh, 														companyWithSexPriceHigh, 														sexPriceHigh, 														eroticShowPriceHigh,														origin, 														skinColor, 														hairColor,														hairLength,														eyeColor,														language,														educationLevel,														smoker,														physique,														height,														orientation,														pennisSize,														breastSize,														firstPlaceInSearch,														isOnline,														isFreeContact,														hasAlbum,														login);				try{			QueryByCriteria query = new QueryByCriteria( SellerService.class, mainCriteria);						broker = PersistenceBrokerFactory.defaultPersistenceBroker();						if( orderedBy.equals( "seller.login"))				query.addOrderBy( orderedBy, true);			else 				query.addOrderBy( orderedBy, false);						query.addGroupBy( "seller");			query.setStartAtIndex( startIndex);			query.setEndAtIndex( startIndex + offset -1);			return broker.getCollectionByQuery( query);		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( SellerService.class.getName(), this.getClass().getName() + ".getSellerService()", ex);		}finally {			if ( broker != null) {				broker.close();			}		}	}			public int getSellerServiceCount( 	Integer buyerSex, 										Integer sellerSex,										Integer country,										Integer state, 										Date 	birthDateLow, 										Date 	birthDateHigh, 										Integer service,										Integer companyWithoutSexPriceHigh,										Integer companyWithSexPriceHigh,										Integer sexPriceHigh,										Integer eroticShowPriceHigh,										Integer origin,										Integer skinColor,										Integer hairColor,										Integer hairLength,										Integer eyeColor,										Integer language,										Integer educationLevel,										Integer smoker,										Integer physique,										Integer height,										Integer orientation,										Integer pennisSize,										Integer breastSize,										boolean firstPlaceInSearch,										boolean isOnline,										boolean isFreeContact,										boolean hasAlbum,										String login) throws DataAccessErrorException	{		PersistenceBroker 	broker 			= null;		Criteria			mainCriteria	= null;				mainCriteria = getSellerServicePrepareQuery( 	buyerSex, 														sellerSex, 														country, 														state, 														birthDateLow, 														birthDateHigh, 														service, 														companyWithoutSexPriceHigh, 														companyWithSexPriceHigh, 														sexPriceHigh, 														eroticShowPriceHigh,														origin, 														skinColor, 														hairColor,														hairLength,														eyeColor,														language,														educationLevel,														smoker,														physique,														height,														orientation,														pennisSize,														breastSize,														firstPlaceInSearch,														isOnline,														isFreeContact,														hasAlbum,														login);				try{			QueryByCriteria 	query 	= new QueryByCriteria( SellerService.class, mainCriteria);						query.addGroupBy( "seller");						broker = PersistenceBrokerFactory.defaultPersistenceBroker();						// TODO ESTO ASI ES MUY INEFICIENTE. PERO ES QUE NO FUNCIONA EL GETCOUNT() CON QUERYS QUE			// TENGAN GROUPBY. MIRAR A VER SI SE PUEDE ARREGLAR			return broker.getCollectionByQuery( query).size();		}catch ( PersistenceBrokerException ex) {			throw new DataAccessErrorException( SellerService.class.getName(), this.getClass().getName() + ".getSellerServiceCount()", ex);		}finally {			if ( broker != null) {			broker.close();			}		}	}		}